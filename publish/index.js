"use strict";var e=require("react"),t=require("react/jsx-runtime");let n,r;const s=new Map;(e=>{r||(n={...n,...e},r=new Proxy(n,{get(e,t){if("string"==typeof t&&t in e)return e[t]},set(e,t,n){if("string"==typeof t){const r=e[t];if(JSON.stringify(r)!==JSON.stringify(n)){e[t]=n;const r=s.get(t);r&&r.forEach((e=>e(n)))}return!0}return!1}}))})({styleData:null});const o="State is not initialized yet 👺",c=(e,t)=>(s.has(e)||s.set(e,new Set),s.get(e)?.add(t),()=>s.get(e)?.delete(t)),a=t=>{const n=()=>(r?{...r}:(console.warn(o),{}))[t];return[e.useSyncExternalStore((e=>c(t,e)),n,n),e.useCallback((e=>{const s=n(),c="function"==typeof e?e(s):e;var a,l;Object.is(s,c)||(a=t,l=c,r?r[a]=l:console.warn(o))}),[t])]},l=(e,t)=>e.length===t.length&&e.every(((e,n)=>e===t[n])),i=({id:e,fileNames:t})=>{if(t&&t.forEach((e=>{const t=document.head.querySelector(`style[name="${e}"]`);t&&t.remove()})),e&&!t){document.head.querySelectorAll(`style[atom="${e}"]`).forEach((e=>{e.remove()}))}},u=(e,t)=>{let n=document.head.querySelector(`style[name="${t}"]`);return n||(n=document.createElement("style"),n.setAttribute("atom",e),n.setAttribute("name",t),document.head.appendChild(n)),n},f=t=>{const[n,r]=a("styleData"),s=e.useRef({}),o=e.useRef({}),c=e=>{Object.entries(e??{}).forEach((([e,n])=>{const c=s.current?.[e];let a=[];if(c){const e=c.fileNames||[],t=n.fileNames||[];a=e.filter((e=>!t.includes(e)))}(async(e,t,n,r,s)=>{const o=Object.keys(e)[0],{fileNames:c,encap:a,loaded:i}=e[o];if(c&&0!==c.length){c.forEach((e=>{e in s.current||(s.current[e]=0)}));for(const e of c){const f=u(o,e);try{const{default:t}=await n(e);f.textContent=a?`.${e}{${t}}`:t,s.current[e]+=1}catch(t){console.error(`Loading failed for "${e}" style`,"\n",t,"\n","✦styledAtom✦"),f.textContent="⛔︎",s.current[e]+=1}finally{const e=c.every((e=>s.current[e]>0));t&&l(t?.fileNames||[],c||[])&&i||!e||(r((e=>({...e,[o]:{...e?.[o],loaded:!0}}))),c.forEach((e=>{delete s.current[e]})))}}}else console.warn(`No files to load for id "${o}"`,"\n","✦styledAtom✦")})({[e]:n},c||{},t,r,o),c&&a.length>0&&i({id:e,fileNames:a})}))};e.useEffect((()=>{const e=Object.keys(s.current??{}),t=n?Object.keys(n):[];e.filter((e=>!t.includes(e))).forEach((e=>i({id:e}))),n&&c(n),s.current={...n}}),[n])},d="✦styledAtom✦",y="empty",m=(e,t)=>{"undefined"!=typeof window&&("set"===e?sessionStorage.setItem(d,JSON.stringify(t)):sessionStorage.removeItem(d))};exports.StyleCore=({path:t,watch:s})=>{f(t);const a=r?{...r}:(console.warn(o),{});return e.useEffect((()=>{const e=sessionStorage.getItem(d);if(!s)return void(e&&m("remove"));if(!e){if(!a.styleData)return void m("set",y);m("set",a.styleData)}const t=(e=>{const t=[];for(const s in n)t.push(c(s,(()=>{e({...r})})));return()=>{t.forEach((e=>e()))}})((e=>{e.styleData?m("set",e.styleData):m("set",y)}));return()=>{t(),e&&m("remove")}}),[a]),null},exports.StyledAtom=({fileNames:n,encap:r,fallback:s,onLoad:o,children:c})=>{const[l,i]=a("styleData"),u=e.useRef(!1),f=`✦${e.useId()}`.replace(/[:r]/g,""),d=l?.[f]?.loaded??!1,y=r?t.jsx("div",{className:n.join(" "),children:c}):c;return e.useEffect((()=>(i((e=>({...e,[f]:{...e?.[f],encap:r,fileNames:n}}))),()=>{i((e=>{if(!e)return null;const{[f]:t,...n}=e;return Object.keys(n).length?n:null})),o&&o(!1),u.current=!1})),[n,f,i]),e.useEffect((()=>{o&&d&&!u.current?(o(d),u.current=!0):d||(u.current=!1)}),[d,o]),c?d?y:s||null:null};
