"use strict";var e=require("react"),t=require("react/jsx-runtime");let n,r;const s=new Map;(e=>{r||(n={...n,...e},r=new Proxy(n,{get(e,t){if("string"==typeof t&&t in e)return e[t]},set(e,t,n){if("string"==typeof t){const r=e[t];if(JSON.stringify(r)!==JSON.stringify(n)){e[t]=n;const r=s.get(t);r&&r.forEach((e=>e(n)))}return!0}return!1}}))})({styleData:null});const o="State is not initialized yet 👺",c=(e,t)=>(s.has(e)||s.set(e,new Set),s.get(e)?.add(t),()=>s.get(e)?.delete(t)),l=t=>{const n=()=>(r?{...r}:(console.warn(o),{}))[t];return[e.useSyncExternalStore((e=>c(t,e)),n,n),e.useCallback((e=>{const s=n(),c="function"==typeof e?e(s):e;var l,a;Object.is(s,c)||(l=t,a=c,r?r[l]=a:console.warn(o))}),[t])]},a=(e,t)=>e.length===t.length&&e.every(((e,n)=>e===t[n])),i=({id:e,fileNames:t})=>{if(t&&t.forEach((e=>{const t=document.head.querySelector(`style[name="${e}"]`);t&&t.remove()})),e&&!t){document.head.querySelectorAll(`style[atom="${e}"]`).forEach((e=>{e.remove()}))}},u=(e,t)=>{let n=document.head.querySelector(`style[name="${t}"]`);return n||(n=document.createElement("style"),n.setAttribute("atom",e),n.setAttribute("name",t),document.head.appendChild(n)),n},f=t=>{const[n,r]=l("styleData"),s=e.useRef({}),o=e.useRef({}),c=e=>{Object.entries(e??{}).forEach((([e,n])=>{const c=s.current?.[e];let l=[];if(c){const e=c.fileNames||[],t=n.fileNames||[];l=e.filter((e=>!t.includes(e)))}(async(e,t,n,r,s)=>{const o=Object.keys(e)[0],{fileNames:c,loaded:l}=e[o];if(c&&0!==c.length){c.forEach((e=>{e in s.current||(s.current[e]=0)}));for(const e of c){const i=u(o,e);try{const{default:t}=await n(e);i.textContent=t,s.current[e]+=1}catch(t){console.error(`Loading failed for "${e}" style`,"\n",t,"\n","✦styledAtom✦"),i.textContent="⛔︎",s.current[e]+=1}finally{const e=c.every((e=>s.current[e]>0));t&&a(t?.fileNames||[],c||[])&&l||!e||(r((e=>({...e,[o]:{...e?.[o],loaded:!0}}))),c.forEach((e=>{delete s.current[e]})))}}}else console.warn(`No files to load for id "${o}"`,"\n","✦styledAtom✦")})({[e]:n},c||{},t,r,o),c&&l.length>0&&i({id:e,fileNames:l})}))};e.useEffect((()=>{const e=Object.keys(s.current??{}),t=n?Object.keys(n):[];e.filter((e=>!t.includes(e))).forEach((e=>i({id:e}))),n&&c(n),s.current={...n}}),[n])},d="✦styledAtom✦",y="empty",m=(e,t)=>{"undefined"!=typeof window&&("set"===e?sessionStorage.setItem(d,JSON.stringify(t)):sessionStorage.removeItem(d))};exports.StyleCore=({path:t,watch:s})=>{f(t);const l=r?{...r}:(console.warn(o),{});return e.useEffect((()=>{const e=sessionStorage.getItem(d);if(!s)return void(e&&m("remove"));if(!e){if(!l.styleData)return void m("set",y);m("set",l.styleData)}const t=(e=>{const t=[];for(const s in n)t.push(c(s,(()=>{e({...r})})));return()=>{t.forEach((e=>e()))}})((e=>{e.styleData?m("set",e.styleData):m("set",y)}));return()=>{t(),e&&m("remove")}}),[l]),null},exports.StyledAtom=({fileNames:n,fallback:r,onLoad:s,children:o})=>{const[c,a]=l("styleData"),i=e.useRef(!1),u=`✦${e.useId()}`.replace(/[:r]/g,""),f=c?.[u]?.loaded??!1;return e.useEffect((()=>(a((e=>({...e,[u]:{...e?.[u],fileNames:n}}))),()=>{a((e=>{if(!e)return null;const{[u]:t,...n}=e;return Object.keys(n).length?n:null})),s&&s(!1),i.current=!1})),[n,u,a]),e.useEffect((()=>{s&&f&&!i.current?(s(f),i.current=!0):f||(i.current=!1)}),[f,s]),o?f?t.jsx(t.Fragment,{children:o}):r||null:null};
